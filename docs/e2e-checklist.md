# E2Eチェックリスト（機内モード）

対象: iOS/Android 実機

## 0. 事前準備

1. ターミナル1（配信）

```bash
npx serve . -l 8787 --cors
```

2. ターミナル2（アプリ）

```bash
$env:EXPO_PUBLIC_MANIFEST_BASE_URL="http://<PCのIP>:8787/ryoka-content/"
npm run start
```

3. 実機で同一Wi-Fiに接続し、アプリを起動

## 1. 初期表示

- 曲一覧が表示される
- 元号セクション（明治/大正/昭和/平成/令和/その他）が折り畳みできる
- 曲行に `年度 / 曲名 / 作歌・作曲者` が表示される

## 2. オンライン再生

- 任意の曲で再生開始できる
- ミニプレイヤーで `Play/Pause/Prev/Next` が動く
- 歌詞リンクで歌詞画面が開く
- 楽譜リンクでPDF画面が開く

## 3. ダウンロード（iOS/Androidのみ）

- DLボタンで進捗が `%` 表示される
- 完了後に `DL状態: 済` になる
- 削除ボタンで `DL状態: 未` に戻る

## 4. 機内モード

1. 1曲以上ダウンロード済みの状態にする
2. 実機を機内モードにする
3. ダウンロード済み曲で以下を確認
- 再生できる
- 歌詞表示できる
- 楽譜表示できる
4. 未DL曲はオフライン再生できないことを確認

## 5. 更新検知

1. `ryoka-content/manifest.json` の対象曲 `updatedAt` または `hash/size` を変更
2. アプリを再読み込み
3. 対象曲が `更新あり` 表示になる
4. 再DL後に `済` へ戻る
