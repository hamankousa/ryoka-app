# E2Eチェックリスト

最終更新: 2026-02-17

対象: iOS/Android 実機（Webは一部確認）

## 0. 事前準備

1. コンテンツ配信

```bash
npx serve . -l 8787 --cors
```

2. アプリ起動

```bash
$env:EXPO_PUBLIC_MANIFEST_BASE_URL="http://<PCのIP>:8787/ryoka-content/"
# Web
npm run web
# iOS Expo Go
npm run start:go
```

## 1. タブ初期表示

- `ホーム / 検索 / 一覧 / ライブラリ` が表示される
- 下部にミニプレイヤー（未選択時は `未選択`）が見える

## 2. 検索タブ

- キーワード検索が動く
- 元号 -> 年代 -> 年次 フィルタが動く
- 各曲の `Vocal/Piano` 再生、`歌詞/楽譜/詳細` 遷移が動く

## 3. 一覧タブ

- 元号セクションごとに曲数付きで表示される
- 行内の再生・リンク・DL操作が動く
- `表示中を一括DL / 全中止 / 失敗再試行` が動く

## 4. ライブラリタブ

- 保存曲数が正しく表示される
- 曲単位の `再試行 / 中止 / 削除` が動く
- `全曲一括DL / 全中止 / 失敗再試行` が動く

## 5. 共通ミニプレイヤー

- どのタブでも同じ再生状態が見える
- 最小化状態でシークバーと時間が表示される
- 展開プレイヤーに拡張できる
- 展開中に下ドラッグで閉じられる

## 6. 展開プレイヤー操作

- `シャッフル / 戻る / 再生・一時停止 / 進む / ループ` が動く
- ループが `off / playlist / track` で循環する
- テンポ・音色・オクターブ（MIDI時）が変更できる

## 7. オフライン

1. 1曲以上DL
2. 機内モードON
3. DL済み曲で以下確認
- 再生
- 歌詞
- 楽譜
4. 未DL曲は失敗する

## 8. MIDIバックエンド

- Web: Piano(MIDI)が再生される
- Expo Go: Piano失敗時にVocalへフォールバック（無音/クラッシュしない）
- Dev Client: native-midi 実装済み環境ならPiano制御が動く
