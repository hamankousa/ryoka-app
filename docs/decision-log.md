# Decision Log

## 2026-02-06

- テーマ: ルール管理
- 決定: ルールの正本を `AGENTS.md` に集約
- 理由: 実装と運用の判断を一本化し、変更時の追跡を簡単にするため

## 2026-02-06

- テーマ: 開発リソース運用
- 決定: 初期開発は `sample-content/` に置いたサンプルデータを配信元として使う
- 理由: 仕様検証を止めずに進め、後から実データへ安全に差し替えできるため

## 2026-02-06

- テーマ: Git運用の権限
- 決定: Codex は必要に応じて `git` コマンドを自由に使う
- 理由: 履歴確認や差分確認を即時に行い、開発速度と正確性を維持するため

## 2026-02-06

- テーマ: 音源データ構造
- 決定: 音源は `vocal` と `piano` を分離して管理する
- 理由: ユーザーが歌唱あり/伴奏のみを選べる拡張性を先に確保するため

## 2026-02-06

- テーマ: 開発時の画面確認
- 決定: 変更を加えたら毎回 `web` 実画面を起動して確認する
- 理由: 実装とUIの乖離を早期に検知するため

## 2026-02-06

- テーマ: 曲一覧データ管理
- 決定: 曲一覧（manifest）は `../ryoka-content/manifest.json` で管理する
- 理由: アプリ本体とコンテンツ更新を分離し、将来の配信切替を簡単にするため

## 2026-02-06

- テーマ: web起動運用
- 決定: web起動はユーザーが別ターミナルで手動実行する
- 理由: 開発中の確認フローを固定し、起動状態をユーザーが把握しやすくするため

## 2026-02-06

- テーマ: コンテンツ配置
- 決定: `manifest` だけでなく `audio/lyrics/score` も `ryoka-content` に集約する
- 理由: コンテンツ管理を1か所にまとめ、運用時の混乱を避けるため

## 2026-02-06

- テーマ: ピアノ音源フォーマット
- 決定: ピアノ音源は `mp3` ではなく `midi` を配信元として扱う
- 理由: 伴奏データを軽量に管理し、将来の音源生成/差し替えをしやすくするため

## 2026-02-06

- テーマ: WebのMIDI再生方式
- 決定: Webは `expo-av` ではなく専用MIDI再生エンジンを使う
- 理由: ブラウザ環境で `.midi` を音声ソースとして直接デコードできないため

## 2026-02-06

- テーマ: MIDIプレイヤー操作性
- 決定: ミニプレイヤーに `シークバー` `テンポ変更` `音色変更` を追加する
- 理由: 練習用途で伴奏の再生制御を細かく行えるようにするため

## 2026-02-06

- テーマ: MIDIプレイヤー追加要件
- 決定: `ループ再生` と `テンポ上限3.0x` と `日本語音色ラベル`（ピアノ含む）を採用する
- 理由: 実運用での反復練習とUI可読性を優先するため

## 2026-02-06

- テーマ: 年度クイック検索UI
- 決定: 年次件数が多い元号は `元号 -> 年代 -> 年次` の段階選択にする
- 理由: 昭和などの大量チップを直接表示すると可読性と操作性が落ちるため

## 2026-02-06

- テーマ: 表示テーマ
- 決定: `Liquid Glass` デザインを導入し、トグルで ON/OFF 切替可能にする
- 理由: 可読性を維持しつつ、用途に応じて視覚的な情報密度を選べるようにするため
